webpackJsonp([15],{"3K/Q":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[r("hr"),t._v(" "),r("h2",{attrs:{id:"name%3A-python%E7%88%AC%E8%99%ABlayout%3A-posttitle%3A-%22python%E7%88%AC%E8%99%AB%22info%3A-%22python%E7%88%AC%E8%99%AB%22date%3A-2019-05-05categories%3A-worktags%3A-%5Bpython%5Dcoverimg%3A-%22https%3A%2F%2Fws1.sinaimg.cn%2Flarge%2F88b26e1cgy1fx7cwh57tlj22kw3vc1ky.jpg%22"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#name%3A-python%E7%88%AC%E8%99%ABlayout%3A-posttitle%3A-%22python%E7%88%AC%E8%99%AB%22info%3A-%22python%E7%88%AC%E8%99%AB%22date%3A-2019-05-05categories%3A-worktags%3A-%5Bpython%5Dcoverimg%3A-%22https%3A%2F%2Fws1.sinaimg.cn%2Flarge%2F88b26e1cgy1fx7cwh57tlj22kw3vc1ky.jpg%22","aria-hidden":"true"}},[t._v("#")]),t._v(' name: Python爬虫\nlayout: post\ntitle:  "Python爬虫"\ninfo: "Python爬虫"\ndate:   2019-05-05\ncategories: WORK\ntags: [Python]\ncoverimg: "https://ws1.sinaimg.cn/large/88b26e1cgy1fx7cwh57tlj22kw3vc1ky.jpg"')]),t._v(" "),r("h2",{attrs:{id:"1.-%E7%AE%80%E4%BB%8B"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#1.-%E7%AE%80%E4%BB%8B","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 简介")]),t._v(" "),r("h4",{attrs:{id:"1.%E8%AF%86%E5%88%AB%E7%BD%91%E7%AB%99%E6%89%80%E7%94%A8%E6%8A%80%E6%9C%AF"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#1.%E8%AF%86%E5%88%AB%E7%BD%91%E7%AB%99%E6%89%80%E7%94%A8%E6%8A%80%E6%9C%AF","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.识别网站所用技术")]),t._v(" "),r("pre",{pre:!0,attrs:{class:"hljs"}},[r("code",[t._v('import builtwith\nres = builtwith.parse("http://google.com")\n# 返回字典标识各个模块所使用技术\n')])]),t._v(" "),r("h4",{attrs:{id:"2.%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%AB%99%E6%89%80%E6%9C%89%E8%80%85"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#2.%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%AB%99%E6%89%80%E6%9C%89%E8%80%85","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.查看网站所有者")]),t._v(" "),r("pre",{pre:!0,attrs:{class:"hljs"}},[r("code",[t._v('import whois\nres = whois.whois("baidu.com")\n')])]),t._v(" "),r("h4",{attrs:{id:"3.%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E4%BB%A3%E7%90%86"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#3.%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E4%BB%A3%E7%90%86","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.设置用户代理")]),t._v(" "),r("pre",{pre:!0,attrs:{class:"hljs"}},[r("code",[t._v('from fake_useragent import UserAgent\nrequest.headers["User-Agent"] = UserAgent().random\n')])]),t._v(" "),r("h4",{attrs:{id:"4.%E8%AE%BE%E7%BD%AEip%E4%BB%A3%E7%90%86"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#4.%E8%AE%BE%E7%BD%AEip%E4%BB%A3%E7%90%86","aria-hidden":"true"}},[t._v("#")]),t._v(" 4.设置IP代理")]),t._v(" "),r("ul",[r("li",[t._v("具备高可用IP代理池可存数据库或.json文件")]),t._v(" "),r("li",[t._v("使用代理请求时间会加长，会增加请求失败概率，需增加retry")])]),t._v(" "),r("pre",{pre:!0,attrs:{class:"hljs"}},[r("code",[t._v('def get_random_proxy():\n    with open("./proxy.json") as fd:\n        res = fd.readlines()\n    proxy = "http://" + random.choice(res).strip()\n    return proxy\nproxy = get_random_proxy()\nrequest.meta["proxy"] = proxy\n')])]),t._v(" "),r("h2",{attrs:{id:"2.%E6%95%B0%E6%8D%AE%E6%8A%93%E5%8F%96"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#2.%E6%95%B0%E6%8D%AE%E6%8A%93%E5%8F%96","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.数据抓取")]),t._v(" "),r("h4",{attrs:{id:"1.html%E8%A7%A3%E6%9E%90%E6%96%B9%E5%BC%8F"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#1.html%E8%A7%A3%E6%9E%90%E6%96%B9%E5%BC%8F","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.HTML解析方式")]),t._v(" "),r("ul",[r("li",[t._v("正则表达式")]),t._v(" "),r("li",[t._v("bs4 使用Python编写速度一般")]),t._v(" "),r("li",[t._v("lxml 使用C语言编写，速度较快")])]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",{staticStyle:{"text-align":"left"}},[t._v("解析方法")]),t._v(" "),r("th",{staticStyle:{"text-align":"left"}},[t._v("性能")]),t._v(" "),r("th",{staticStyle:{"text-align":"left"}},[t._v("使用难度")]),t._v(" "),r("th",{staticStyle:{"text-align":"left"}},[t._v("安装难度")])])]),t._v(" "),r("tbody",[r("tr",[r("td",{staticStyle:{"text-align":"left"}},[t._v("re")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("块")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("困难")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("简单(标准库)")])]),t._v(" "),r("tr",[r("td",{staticStyle:{"text-align":"left"}},[t._v("bs4")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("慢")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("简单")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("简单( python编写)")])]),t._v(" "),r("tr",[r("td",{staticStyle:{"text-align":"left"}},[t._v("lxml")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("块")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("简单")]),t._v(" "),r("td",{staticStyle:{"text-align":"left"}},[t._v("相对困难")])])])]),t._v(" "),r("h4",{attrs:{id:"%E4%BD%BF%E7%94%A8selenium%E5%8A%A0%E8%BD%BDjs%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E5%86%85%E5%AE%B9"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#%E4%BD%BF%E7%94%A8selenium%E5%8A%A0%E8%BD%BDjs%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E5%86%85%E5%AE%B9","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用selenium加载js动态加载内容")]),t._v(" "),r("ul",[r("li",[t._v("入参为需解析的URL链接，返回动态加载后的页面")])]),t._v(" "),r("pre",{pre:!0,attrs:{class:"hljs"}},[r("code",[t._v("from selenium import webdriver\n\ndef get_html(url):\n    # 设置不跳出浏览器界面\n    chrome_options = webdriver.ChromeOptions()\n    chrome_options.add_argument('--headless')\n    chrome_options.add_argument('--disable-gpu')\n    \n    # Chrome Driver path\n    path =  \"./lib/chromedriver\"\n    driver = webdriver.Chrome(\n        options=chrome_options,\n        executable_path=path\n    )\n    driver.get(url)\n    html = driver.page_source\n    return html\n")])]),t._v(" "),r("ul",[r("li",[t._v("入参为html字符串，通过正则匹配所需url")])]),t._v(" "),r("pre",{pre:!0,attrs:{class:"hljs"}},[r("code",[t._v('def get_url(html):\n    re_audio = "(<audio[^>]*>.*?</audio>)"\n    audio = re.findall(re_audio, html)[0]\n    re_url = "(https?://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|])"\n    url = re.findall(re_url, audio)[0]\n    return url\n')])]),t._v(" "),r("ul",[r("li",[t._v("使用xpath解析数据")])]),t._v(" "),r("pre",{pre:!0,attrs:{class:"hljs"}},[r("code",[t._v('from lxml import etree\n\ndef parse_html(html):\n    """入参为HTML字符串，返回评论的用户名称和用户头像"""\n    node = etree.HTML(html, etree.HTMLParser())\n    res = node.xpath(\'//li[@class="c-item"]\')\n    for li in res:\n        avatar = li.xpath(\'.//img/@src\')[0]\n        uname = li.xpath(\'.//div[@class="c-user-info"]/a/text()\')[0]\n        print("%s,%s" % (uname, avatar))\n\n    next_urls = node.xpath(\'//a[@class="link"]/@href\')\n    return next_urls\n')])])])}]},n=r("VU/8")(null,a,!1,null,null,null);e.default=n.exports}});
//# sourceMappingURL=15.1c271c159970f107447f.js.map