webpackJsonp([6],{esx8:function(t,e,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"content"},[l("hr"),t._v(" "),l("h2",{attrs:{id:"name%3A-mongoenginelayout%3A-posttitle%3A-%22mongoengine%22info%3A-%22mongoengine%22date%3A-2019-05-05categories%3A-worktags%3A-%5Bmongodb%2C-mongoengine%5Dcoverimg%3A-%22https%3A%2F%2Fws1.sinaimg.cn%2Flarge%2F88b26e1cgy1fx7cwh57tlj22kw3vc1ky.jpg%22"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#name%3A-mongoenginelayout%3A-posttitle%3A-%22mongoengine%22info%3A-%22mongoengine%22date%3A-2019-05-05categories%3A-worktags%3A-%5Bmongodb%2C-mongoengine%5Dcoverimg%3A-%22https%3A%2F%2Fws1.sinaimg.cn%2Flarge%2F88b26e1cgy1fx7cwh57tlj22kw3vc1ky.jpg%22","aria-hidden":"true"}},[t._v("#")]),t._v(' name: Mongoengine\nlayout: post\ntitle:  "Mongoengine"\ninfo: "Mongoengine"\ndate:   2019-05-05\ncategories: WORK\ntags: [MongoDB, MongoEngine]\ncoverimg: "https://ws1.sinaimg.cn/large/88b26e1cgy1fx7cwh57tlj22kw3vc1ky.jpg"')]),t._v(" "),l("h2",{attrs:{id:"mongoengine%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#mongoengine%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8","aria-hidden":"true"}},[t._v("#")]),t._v(" mongoengine基本使用")]),t._v(" "),l("h4",{attrs:{id:"document%E5%AE%9A%E4%B9%89"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#document%E5%AE%9A%E4%B9%89","aria-hidden":"true"}},[t._v("#")]),t._v(" Document定义")]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("from mongoengine import Document\nclass User(Document):\n    \"\"\"User表\"\"\"\n    catid = IntField(required=True, primary_key=True)      # 专辑分类id\n    name = StringField(max_length=100,unique=True)         # 分类名称\n    intro = StringField(default='',unique_with='name')     # 分类介绍\n    is_free = BooleanField(default=True)                   # 是否免费\n    meta = {\n        'collection': 'album_categories',\n        'indexes': [\n            'catid',\n            'pid',\n            'name'\n        ],\n    }\n")])]),t._v(" "),l("ul",[l("li",[t._v("继承类说明")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[t._v("字段")]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("Document")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("只允许写入定义好的字段")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("DynamicDocument")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("可以写入为定义字段和灵活查询")])])])]),t._v(" "),l("ul",[l("li",[t._v("字段类型")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[t._v("字段")]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("IntField")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("整型，32-bit integer field.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("LongField")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("64-bit integer field.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("StringField")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("字符串类型，The maximum BSON document size is 16 megabytes.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("BooleanField")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("布尔值类型")])])])]),t._v(" "),l("ul",[l("li",[t._v("字段参数说明")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[t._v("字段")]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("required")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("True则该列必传参数")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("primary_key")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("主键")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("max_length")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("最大长度")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("unique")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("该列唯一约束")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("unique_with")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("同等号后的列联合唯一约束")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("default")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("默认值")])])])]),t._v(" "),l("ul",[l("li",[t._v("meta参数说明")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[t._v("字段")]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("collection")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("集合名称")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("indexes")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("索引列")])])])]),t._v(" "),l("h4",{attrs:{id:"%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5","aria-hidden":"true"}},[t._v("#")]),t._v(" 数据库连接")]),t._v(" "),l("ul",[l("li",[t._v("需要鉴权登录")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("from mongoengine import connect\nconnect(\n    host='mongodb://admin:qwerty@localhost/production'\n)\n\nwill establish connection to production database using admin username and qwerty password.\n")])]),t._v(" "),l("ul",[l("li",[t._v("无需要鉴权登录")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("connect(\n    host='mongodb://127.0.0.1:27017/production'\n)\n")])]),t._v(" "),l("h4",{attrs:{id:"%E5%A2%9E"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#%E5%A2%9E","aria-hidden":"true"}},[t._v("#")]),t._v(" 增")]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("from mongo import User\n\nUser(\n    catid=1,\n    name='Fanjr',\n    intro='Cool',\n    id_free=True\n).save()\n")])]),t._v(" "),l("p",[t._v("-注：MongoEngine中id和pk为primary_key的别称，不可使用")]),t._v(" "),l("h4",{attrs:{id:"%E5%88%A0"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#%E5%88%A0","aria-hidden":"true"}},[t._v("#")]),t._v(" 删")]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("num = User.objects(catid=1).delete()\n# 返回删除个数\n")])]),t._v(" "),l("h4",{attrs:{id:"%E6%94%B9"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#%E6%94%B9","aria-hidden":"true"}},[t._v("#")]),t._v(" 改")]),t._v(" "),l("ul",[l("li",[t._v("更改符合条件结果集所有数据")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("User.objects.update(catid=1)\n")])]),t._v(" "),l("ul",[l("li",[t._v("更改符合条件结果集第一条数据")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("User.objects.update_one(catid=1)\n")])]),t._v(" "),l("h4",{attrs:{id:"%E6%9F%A5"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#%E6%9F%A5","aria-hidden":"true"}},[t._v("#")]),t._v(" 查")]),t._v(" "),l("ul",[l("li",[t._v("Demo查询")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("from mongo import User\n\nuser = User.objects(catid__gte=1)\n# 返回catid大于等于1的用户集\n")])]),t._v(" "),l("ul",[l("li",[t._v("查询满足条件单条记录，无返回None")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("from mongo import User\nuser = User.objects(name='1')\n")])]),t._v(" "),l("ul",[l("li",[t._v("查询某一列的和")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("_sum = User.objects.sum('catid')\n")])]),t._v(" "),l("ul",[l("li",[t._v("查询某一列的平均数")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("_sum = User.objects.average('catid')\n")])]),t._v(" "),l("ul",[l("li",[t._v("查询一列数据")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v(">>> class Film(Document):\n...     title = StringField()\n...     year = IntField()\n...     rating = IntField(default=3)\n...\n>>> Film(title='The Shawshank Redemption', year=1994, rating=5).save()\n>>> f = Film.objects.only('title').first()\n>>> f.title\n'The Shawshank Redemption'\n>>> f.year   # None\n>>> f.rating # default value\n3\n")])]),t._v(" "),l("ul",[l("li",[t._v("高级查询")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("from mongoengine.queryset.visitor import Q\n\n# Get published posts\nPost.objects(Q(published=True) | Q(publish_date__lte=datetime.now()))\n\n# Get top posts\nPost.objects((Q(featured=True) & Q(hits__gte=1000)) | Q(hits__gte=5000))\n\n")])]),t._v(" "),l("ul",[l("li",[t._v("可用算子")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[t._v("算子")]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("ne")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("not equal to")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("lt")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("less than")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("lte")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("less than or equal to")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("gt")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("greater than")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("gte")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("greater than or equal to")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("not")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("negate a standard check, may be used before other operators (e.g. Q(age__not__mod=5))")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("in")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("value is in list (a list of values should be provided)")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("nin")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("value is not in list (a list of values should be provided)")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("mod")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("value % x == y, where x and y are two provided values")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("all")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("every item in list of values provided is in array")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("size")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("the size of the array is")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("exists")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("value for field exists")])])])]),t._v(" "),l("ul",[l("li",[t._v("字符串算子")])]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[t._v("算子")]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("exact")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("string field exactly matches value")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("iexact")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("string field exactly matches value (case insensitive)")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("contains")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("string field contains value")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("icontains")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("string field contains value (case insensitive)")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("startswith")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("string field starts with value")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("istartswith")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("string field starts with value (case insensitive)")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("endswith")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("string field ends with value")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("iendswith")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("string field ends with value (case insensitive)")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("match")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("performs an $elemMatch so you can match an entire document within an array")])])])]),t._v(" "),l("ul",[l("li",[t._v("自定义查询方法一")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("class BlogPost(Document):\n    title = StringField()\n    published = BooleanField()\n\n    @queryset_manager\n    def live_posts(doc_cls, queryset):\n        return queryset.filter(published=True)\n\nBlogPost(title='test1', published=False).save()\nBlogPost(title='test2', published=True).save()\nassert len(BlogPost.objects) == 2\nassert len(BlogPost.live_posts()) == 1\n")])]),t._v(" "),l("ul",[l("li",[t._v("自定义查询方法二")])]),t._v(" "),l("pre",{pre:!0,attrs:{class:"hljs"}},[l("code",[t._v("class AwesomerQuerySet(QuerySet):\n\n    def get_awesome(self):\n        return self.filter(awesome=True)\n\nclass Page(Document):\n    meta = {'queryset_class': AwesomerQuerySet}\n\n# To call:\nPage.objects.get_awesome()\n")])]),t._v(" "),l("h4",{attrs:{id:"%E6%9F%A5%E8%AF%A2%E9%9B%86%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#%E6%9F%A5%E8%AF%A2%E9%9B%86%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95","aria-hidden":"true"}},[t._v("#")]),t._v(" 查询集常用方法")]),t._v(" "),l("table",[l("thead",[l("tr",[l("th",{staticStyle:{"text-align":"left"}},[t._v("方法")]),t._v(" "),l("th",{staticStyle:{"text-align":"left"}},[t._v("注释")])])]),t._v(" "),l("tbody",[l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("all()")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Returns a copy of the current QuerySet.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("average(field)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Average over the values of the specified field.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("count(with_limit_and_skip=False)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Count the selected elements in the query.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("delete()")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Delete the documents matched by the query.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("distinct(field)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Return a list of distinct values for a given field.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("exclude(*fields)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Opposite to .only(), exclude some document’s fields.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("only(*fields)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Load only a subset of this document’s fields.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("first()")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Retrieve the first object matching the query.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("get()")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("多个匹配触发MultipleObjectsReturned，无匹配DoesNotExist")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("limit(n)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Limit the number of returned documents to n. or (e.g. User.objects[:5]).")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("order_by(*keys)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Order the QuerySet by the keys.  keys by +a(asc) or -a(desc)")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("skip(n)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Skip n documents before returning the results. or (e.g. User.objects[5:]).")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("sum(field)")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Sum over the values of the specified field.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("to_json()")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Converts a queryset to JSON")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("update()")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Perform an atomic update on the fields matched by the query.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("update_one")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Perform an atomic update on the fields of the first document matched by the query.")])]),t._v(" "),l("tr",[l("td",{staticStyle:{"text-align":"left"}},[t._v("upsert_one")]),t._v(" "),l("td",{staticStyle:{"text-align":"left"}},[t._v("Overwrite or add the first document matched by the query.")])])])]),t._v(" "),l("ul",[l("li",[t._v("注：field为字段名称")])])])}]},i=l("VU/8")(null,a,!1,null,null,null);e.default=i.exports}});
//# sourceMappingURL=6.e1056a300ef1673c3a79.js.map